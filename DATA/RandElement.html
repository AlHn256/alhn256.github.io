<!DOCTYPE html>
<html>
<head>
<title>RandElement</title>
<script type="text/javascript" src="data.json"></script>
<meta charset="utf-8" />
    <script src="modul/jquery-2.2.4.min.js"></script>
    <link href="modul/toastr.css" rel="stylesheet"/>
    <script src="modul/toastr.js"></script>
	<style>
     .flex-container {
     display: flex;
     align-items: center; /* Подставьте другое значение и посмотрите результат */
     width: 90%;
     <!-- background-color: #aaaaaa; -->
     }
     .flex-container > div {
     width: 66%;
     padding: 5px 0;
     margin: 5px;
     <!-- background-color: lightgrey; -->
     text-align: left;
     font-size: 35px;
     }
    </style>
</head>
<body>

<div>
	<div style="height: 55px;">
	
	</div>
	<div class="flex-container">
		<div>
			<div>
			<textarea id="textarea" style="height: 1200px; width: 100%;"></textarea>
			</div>
			<div>
				<button class="btn" id='Button3' class="btn" type="button" style="width: 70px;margin-top: 20px;">
					<input type="checkbox" name="checkbox3" id="Checkbox3"/>
					<h2> 3 </h2>
				</button>
				<button class="btn" id='Button4' class="btn" type="button" style="width: 70px;margin-top: 20px;">
					<input type="checkbox" name="checkbox4" id="Checkbox4" checked/>
					<h2> 4 </h2>
				</button>
				<button class="btn" id='Button5' class="btn" type="button" style="width: 70px;margin-top: 20px;">
					<input type="checkbox" name="checkbox5" id="Checkbox5" checked/>
					<h2> 5 </h2>
				</button>
			</div>
		</div>
		<div style="width: 210px;height: 410px; margin-left: auto; margin-bottom: auto;">
			<button style="width: 200px;height: 200px;" class="btn" id='randButton' class="btn" type="button">
			<h2> Rand </h2>
			</button>
			<button style="width: 200px;height: 200px; margin-top: 20px;" class="btn" id='TextButton' class="btn" type="button">
			<h2> Text </h2>
			</button>
			<button style="width: 200px;height: 200px; margin-top: 20px;" class="btn" id='BackButton' class="btn" type="button">
			<h2> Back </h2>
			</button>
			<button style="width: 200px;height: 200px; margin-top: 20px;" class="btn" id='NextButton' class="btn" type="button">
			<h2> Next </h2>
			</button>

		</div>

	</div>
</div>
 
<script>
toastr.options.timeOut = 8000; 
toastr.options.positionClass = "toast-top-full-width";
toastr.info('Page Loaded!');

$(document).ready(function() 
	{
	var mydata = JSON.parse(data);
	var SelectedElement = null;
	
	let BackPages = new Array();
	var SelectedPage = -1;
	
	function getRandomArbitrary(max) 
		{
		return Math.floor(Math.random()*(max));
		}
		
	function getElement(Id) 
		{
		for (const element of mydata) 
			{
				if (element.Id === Id) 
				{
				element.IsRead = true;
				SelectedElement = element;
				console.log("SelectedElement ",SelectedElement);
				toastr.success(SelectedElement.Name);
				}
			}
		}
		
    $('#Button3').click(function() 
		{
		if($("#Checkbox3").is(":checked"))$('#Checkbox3').prop('checked', false);
		else $('#Checkbox3').prop('checked', true);
		getData();
		});
		
	$('#Checkbox3').change(function()
		{
		console.log("Checkbox3");
		getData();
		});
		
	$('#Button4').click(function() 
		{
		if($("#Checkbox4").is(":checked"))$('#Checkbox4').prop('checked', false);
		else $('#Checkbox4').prop('checked', true);
		getData();
		});
		
	$('#Checkbox4').change(function()
		{
		console.log("Checkbox4");
		getData();
		});
			
	$('#Button5').click(function() 
		{
		if($("#Checkbox5").is(":checked"))$('#Checkbox5').prop('checked', false);
		else $('#Checkbox5').prop('checked', true);
		getData();
		});	
		
	$('#Checkbox5').change(function()
		{
		console.log("Checkbox5");
		getData();
		});
		
    $('#BackButton').click(function() 
		{
		SelectedPage = SelectedPage-1;
		if(SelectedPage<0) SelectedPage=0;
		else getElement(BackPages[SelectedPage]);
		});
		
    $('#NextButton').click(function() 
		{
		SelectedPage = SelectedPage+1;
		if(SelectedPage > BackPages.length-1)SelectedPage = BackPages.length-1;
		else getElement(BackPages[SelectedPage]);
		});
		
	function getData() 
		{
			let CheckArray = new Array();
			CheckArray[0] = $("#Checkbox3").is(":checked");
			CheckArray[1] = $("#Checkbox4").is(":checked");
			CheckArray[2] = $("#Checkbox5").is(":checked");
			console.log("CheckArray |"+CheckArray[0]+"|"+CheckArray[1]+"|"+CheckArray[2]+"|");
			
			let NewArray = new Array();
			let N = 0;
			for (const element of mydata) 
					{
						let Add = false;
						element.IsRead = false;
						let NewParam = element.NewParam;
						
						for (const Param of NewParam)
						{
							if(Param == 4||Param == 5)Add=true;
						}
						
						if(Add)
						{
							NewArray[N]=element;
							N++;
						}
					}
			console.log("NewArray |",NewArray);
			console.log("mydata |",mydata);
		}
		
    $('#randButton').click(function() 
		{

			let RandomList = mydata.filter(r => r.IsRead == false);
			
			if(RandomList.length == 0)
			{
				console.log("Reloading");
				SelectedPage = -1;
				BackPages = new Array();
				for (const element of mydata) 
					{
						element.IsRead = false;
					}
				RandomList = mydata.filter(r => r.IsRead == false);
				console.log("RandomList.length ",RandomList.length);
			}
			
			let R = Math.floor(Math.random()*(RandomList.length));
			let RandomId = RandomList[R].Id;
			
			if(SelectedPage == -1)SelectedPage = 0;
			else SelectedPage = BackPages.length;
			BackPages[SelectedPage] = RandomId;
			
			getElement(RandomId);
			$('#textarea').val("");
			});
			
			$('#TextButton').click(function() 
			{
				let text ="";
				for (const element of SelectedElement.SplitText) 
				{
					text += element + '\n';
				}
				
				$('#textarea').val(text);
			});
		});
</script>
</body>
</html>